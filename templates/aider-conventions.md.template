# {{project.name}} — Aider Conventions

> Auto-generated by SaasCode Kit from manifest.yaml

## Project

{{project.name}} is a {{project.type}} application for {{project.domain}}.
{{project.description}}

## Stack

- Frontend: {{stack.frontend.framework}} {{stack.frontend.version}}, {{stack.language}}
- Backend: {{stack.backend.framework}} {{stack.backend.version}}, {{stack.backend.orm}}, {{stack.backend.database}}
- Auth: {{auth.provider}}

## Structure

- Backend: {{paths.backend}}/
- Frontend: {{paths.frontend}}/
- Schema: {{paths.schema}}
- API Client: {{paths.api_client}}/
- Components: {{paths.components}}/

## Rules

{{#if tenancy.enabled}}
### Tenant Isolation (CRITICAL)

Every database query MUST be scoped by `{{tenancy.identifier}}`.
Never return unscoped queries — this leaks data across tenants.
Isolation strategy: {{tenancy.isolation}}
{{/if}}

### Authentication

Auth provider: {{auth.provider}}
Guard pattern: {{auth.guard_pattern}}

{{#if_eq auth.guard_pattern "decorator"}}
Every controller needs: @UseGuards(AuthGuard, TenantGuard, RolesGuard)
Bug: @Roles() without RolesGuard = roles silently ignored.
{{/if_eq}}
{{#if_eq auth.guard_pattern "middleware"}}
Every route needs: authenticate → resolveTenant → checkRole middleware chain.
{{/if_eq}}
{{#if_eq auth.guard_pattern "policy"}}
Every action needs: authorize('action', $resource) policy check.
{{/if_eq}}

### Build Order

1. Schema ({{paths.schema}})
2. Backend ({{paths.backend}}/)
3. API Client ({{paths.api_client}}/)
4. Components ({{paths.components}}/)
5. Pages ({{paths.frontend}}/)

### Anti-Patterns

{{#each patterns.anti_patterns}}
- {{this}}
{{/each}}
- Never hardcode secrets
- Never skip {{tenancy.identifier}} scoping
- Never create frontend calls without backend endpoints

{{#if billing.enabled}}
### Billing

Provider: {{billing.provider}} ({{billing.model}})
{{#if billing.webhooks}}Verify webhook signatures. Implement idempotency.{{/if}}
{{/if}}

{{#if ai.enabled}}
### AI

Providers: {{ai.providers}}
Validate inputs before LLM calls. Block prompt injection. Rate limit per tenant.
{{/if}}

## Verification

After changes: `saascode review && saascode parity && saascode sweep`
